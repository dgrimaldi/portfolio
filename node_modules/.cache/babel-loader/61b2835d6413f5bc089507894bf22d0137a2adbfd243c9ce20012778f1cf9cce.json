{"ast":null,"code":"import * as d3 from \"d3\";\nconst graphDimension = {\n  width: 600,\n  height: 450\n};\nconst radius = 100;\nexport const d3CircularPacking = (svg, numberOfCircle) => {\n  // remove all drawn instances to new one\n  d3.selectAll('g').remove();\n  d3.selectAll(\"circle\").remove();\n  d3.create(\"svg\").attr(\"width\", width).attr(\"height\", height).attr(\"viewBox\", [-width / 2, -height / 2, width, height]);\n\n  // create dummy data -> just one element per circle\n  let data = d3.range(numberOfCircle).map(() => ({}));\n\n  // Initialize the circle: all located at the center of the svg area\n  const node = svg.append(\"g\").selectAll(\"circle\").data(data).enter().append(\"circle\").attr(\"r\", 15).attr(\"cx\", graphDimension.width).attr(\"cy\", 250).style(\"fill\", \"#69b3a2\").style(\"fill-opacity\", 0.3).attr(\"stroke\", \"#69a2b2\").style(\"stroke-width\", 4);\n\n  // @ts-ignore\n  node.call(d3.drag().on(\"start\", started).on(\"drag\", dragged).on(\"end\", ended));\n  function ticked() {\n    node.attr(\"cx\", d => d.x).attr(\"cy\", d => d.y);\n  }\n  const simulation = d3.forceSimulation(data).force(\"collide\", d3.forceCollide(radius).iterations(4)).on(\"tick\", ticked);\n  function started(event) {\n    if (!event.active) simulation.alphaTarget(0.3).restart();\n    event.subject.fx = event.subject.x;\n    event.subject.fy = event.subject.y;\n  }\n  function dragged(event) {\n    event.subject.fx = event.x;\n    event.subject.fy = event.y;\n  }\n  function ended(event) {\n    if (!event.active) simulation.alphaTarget(0);\n    event.subject.fx = null;\n    event.subject.fy = null;\n  }\n  return svg;\n};","map":{"version":3,"names":["d3","graphDimension","width","height","radius","d3CircularPacking","svg","numberOfCircle","selectAll","remove","create","attr","data","range","map","node","append","enter","style","call","drag","on","started","dragged","ended","ticked","d","x","y","simulation","forceSimulation","force","forceCollide","iterations","event","active","alphaTarget","restart","subject","fx","fy"],"sources":["/home/dgrimaldi/Documents/portfolio/src/d3/D3CircularPacking.ts"],"sourcesContent":["import {BaseType, SimulationNodeDatum} from \"d3\";\nimport * as d3 from \"d3\";\nconst graphDimension: { width: number, height: number } = { width: 600, height: 450};\nconst radius = 100;\nexport const d3CircularPacking = (svg: d3.Selection<BaseType, unknown, HTMLElement, SVGElement>, numberOfCircle: number) => {\n        // remove all drawn instances to new one\n        d3.selectAll('g').remove()\n        d3.selectAll(\"circle\").remove()\n\n\n        d3.create(\"svg\")\n        .attr(\"width\", width)\n        .attr(\"height\", height)\n        .attr(\"viewBox\", [-width / 2, -height / 2, width, height])\n\n        // create dummy data -> just one element per circle\n        let data: SimulationNodeDatum[] = d3.range(numberOfCircle).map(() => ({}))\n\n        // Initialize the circle: all located at the center of the svg area\n        const node: d3.Selection<SVGCircleElement, SimulationNodeDatum, SVGGElement, unknown> = svg.append(\"g\")\n            .selectAll(\"circle\")\n            .data(data)\n            .enter()\n            .append(\"circle\")\n            .attr(\"r\", 15)\n            .attr(\"cx\", graphDimension.width)\n            .attr(\"cy\", 250)\n            .style(\"fill\", \"#69b3a2\")\n            .style(\"fill-opacity\", 0.3)\n            .attr(\"stroke\", \"#69a2b2\")\n            .style(\"stroke-width\", 4)\n\n\n        // @ts-ignore\n        node.call(d3.drag()\n            .on(\"start\", started)\n            .on(\"drag\", dragged)\n            .on(\"end\", ended));\n        function ticked() {\n            node\n                .attr(\"cx\", (d:any) => d.x)\n                .attr(\"cy\", (d:any)  => d.y);\n        }\n\n        const simulation = d3.forceSimulation(data)\n            .force(\"collide\", d3.forceCollide(radius).iterations(4))\n            .on(\"tick\", ticked);\n        function started(event:any) {\n            if (!event.active) simulation.alphaTarget(0.3).restart();\n            event.subject.fx = event.subject.x;\n            event.subject.fy = event.subject.y;\n        }\n\n        function dragged(event:any) {\n            event.subject.fx = event.x;\n            event.subject.fy = event.y;\n        }\n\n        function ended(event:any) {\n            if (!event.active) simulation.alphaTarget(0);\n            event.subject.fx = null;\n            event.subject.fy = null;\n        }\n        return svg\n\n}"],"mappings":"AACA,OAAO,KAAKA,EAAE,MAAM,IAAI;AACxB,MAAMC,cAAiD,GAAG;EAAEC,KAAK,EAAE,GAAG;EAAEC,MAAM,EAAE;AAAG,CAAC;AACpF,MAAMC,MAAM,GAAG,GAAG;AAClB,OAAO,MAAMC,iBAAiB,GAAGA,CAACC,GAA6D,EAAEC,cAAsB,KAAK;EACpH;EACAP,EAAE,CAACQ,SAAS,CAAC,GAAG,CAAC,CAACC,MAAM,CAAC,CAAC;EAC1BT,EAAE,CAACQ,SAAS,CAAC,QAAQ,CAAC,CAACC,MAAM,CAAC,CAAC;EAG/BT,EAAE,CAACU,MAAM,CAAC,KAAK,CAAC,CACfC,IAAI,CAAC,OAAO,EAAET,KAAK,CAAC,CACpBS,IAAI,CAAC,QAAQ,EAAER,MAAM,CAAC,CACtBQ,IAAI,CAAC,SAAS,EAAE,CAAC,CAACT,KAAK,GAAG,CAAC,EAAE,CAACC,MAAM,GAAG,CAAC,EAAED,KAAK,EAAEC,MAAM,CAAC,CAAC;;EAE1D;EACA,IAAIS,IAA2B,GAAGZ,EAAE,CAACa,KAAK,CAACN,cAAc,CAAC,CAACO,GAAG,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC;;EAE1E;EACA,MAAMC,IAA+E,GAAGT,GAAG,CAACU,MAAM,CAAC,GAAG,CAAC,CAClGR,SAAS,CAAC,QAAQ,CAAC,CACnBI,IAAI,CAACA,IAAI,CAAC,CACVK,KAAK,CAAC,CAAC,CACPD,MAAM,CAAC,QAAQ,CAAC,CAChBL,IAAI,CAAC,GAAG,EAAE,EAAE,CAAC,CACbA,IAAI,CAAC,IAAI,EAAEV,cAAc,CAACC,KAAK,CAAC,CAChCS,IAAI,CAAC,IAAI,EAAE,GAAG,CAAC,CACfO,KAAK,CAAC,MAAM,EAAE,SAAS,CAAC,CACxBA,KAAK,CAAC,cAAc,EAAE,GAAG,CAAC,CAC1BP,IAAI,CAAC,QAAQ,EAAE,SAAS,CAAC,CACzBO,KAAK,CAAC,cAAc,EAAE,CAAC,CAAC;;EAG7B;EACAH,IAAI,CAACI,IAAI,CAACnB,EAAE,CAACoB,IAAI,CAAC,CAAC,CACdC,EAAE,CAAC,OAAO,EAAEC,OAAO,CAAC,CACpBD,EAAE,CAAC,MAAM,EAAEE,OAAO,CAAC,CACnBF,EAAE,CAAC,KAAK,EAAEG,KAAK,CAAC,CAAC;EACtB,SAASC,MAAMA,CAAA,EAAG;IACdV,IAAI,CACCJ,IAAI,CAAC,IAAI,EAAGe,CAAK,IAAKA,CAAC,CAACC,CAAC,CAAC,CAC1BhB,IAAI,CAAC,IAAI,EAAGe,CAAK,IAAMA,CAAC,CAACE,CAAC,CAAC;EACpC;EAEA,MAAMC,UAAU,GAAG7B,EAAE,CAAC8B,eAAe,CAAClB,IAAI,CAAC,CACtCmB,KAAK,CAAC,SAAS,EAAE/B,EAAE,CAACgC,YAAY,CAAC5B,MAAM,CAAC,CAAC6B,UAAU,CAAC,CAAC,CAAC,CAAC,CACvDZ,EAAE,CAAC,MAAM,EAAEI,MAAM,CAAC;EACvB,SAASH,OAAOA,CAACY,KAAS,EAAE;IACxB,IAAI,CAACA,KAAK,CAACC,MAAM,EAAEN,UAAU,CAACO,WAAW,CAAC,GAAG,CAAC,CAACC,OAAO,CAAC,CAAC;IACxDH,KAAK,CAACI,OAAO,CAACC,EAAE,GAAGL,KAAK,CAACI,OAAO,CAACX,CAAC;IAClCO,KAAK,CAACI,OAAO,CAACE,EAAE,GAAGN,KAAK,CAACI,OAAO,CAACV,CAAC;EACtC;EAEA,SAASL,OAAOA,CAACW,KAAS,EAAE;IACxBA,KAAK,CAACI,OAAO,CAACC,EAAE,GAAGL,KAAK,CAACP,CAAC;IAC1BO,KAAK,CAACI,OAAO,CAACE,EAAE,GAAGN,KAAK,CAACN,CAAC;EAC9B;EAEA,SAASJ,KAAKA,CAACU,KAAS,EAAE;IACtB,IAAI,CAACA,KAAK,CAACC,MAAM,EAAEN,UAAU,CAACO,WAAW,CAAC,CAAC,CAAC;IAC5CF,KAAK,CAACI,OAAO,CAACC,EAAE,GAAG,IAAI;IACvBL,KAAK,CAACI,OAAO,CAACE,EAAE,GAAG,IAAI;EAC3B;EACA,OAAOlC,GAAG;AAElB,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}